var shiftProps={};function updateShiftPager(){for(var l=shiftProps.gameInfo.id,e=document.getElementById("shift_code_pager"),d=shiftProps.limit,t=(getClasses(document.getElementById("shift_code_feed"),"shift-code").length,{now:shiftProps.offset/d+1,max:function(){var e=0,t=shiftProps.filter;if(0==t.length)e=shiftStats.total[l];else{var a=!0,s=!1,r=void 0;try{for(var n,i=t[Symbol.iterator]();!(a=(n=i.next()).done);a=!0){var o=n.value;e+=shiftStats[o][l]}}catch(e){s=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}}return Math.ceil(e/d)}(),offset:d,onclick:"shift_header_sort"}),a=Object.keys(t),s=0;s<a.length;s++){var r=a[s];e.setAttribute("data-".concat(r),t[r])}delClass(e,"configured"),e=configurePager(e);var n=!0,i=!1,o=void 0;try{for(var c,f=getTags(e,"button")[Symbol.iterator]();!(n=(c=f.next()).done);n=!0){c.value.addEventListener("click",function(e){var t=tryParseInt(this.getAttribute("data-value"));t!=shiftProps.offset&&(shiftProps.offset=t,getCodes())})}}catch(e){i=!0,o=e}finally{try{n||null==f.return||f.return()}finally{if(i)throw o}}}function getCodes(){var w={fetched:0,added:0},e=document.getElementById("shift_header"),r={total:getClass(e,"badge total"),new:getClass(e,"badge new"),exp:getClass(e,"badge exp")},x=document.getElementById("shift_code_feed");function T(e){var t={};t.overlay=document.getElementById("shift_overlay"),t.spinner=getClass(t.overlay,"spinner"),t.error=getClass(t.overlay,"error");for(var a=Object.keys(e),s=0;s<a.length;s++){var r=a[s];vishidden(t[r],e[r])}}function I(e){for(var t=[r.new,r.exp,document.getElementById("shift_header_sort")],a=0;a<t.length;a++){var s=t[a];hasClass(s,"inactive")||disenable(s,e)}}function L(){for(var e=getClasses(x,"shift-code"),t=e.length-1;0<=t;t--)x.removeChild(e[t])}function n(n){var e,t,a,s,r,o,l,d,c,f,h,g,u,p,v,C=getTemplate("shift_code_template"),y={};function b(e,t){var a=1<arguments.length&&void 0!==t?t:y.body;return getClass(getClass(a,e),"content")}function m(e){return getDate("m-d-y","/",0<arguments.length&&void 0!==e?e:"now")}function _(e,t){var a={start:new Date(e),end:new Date(t)},s=Math.abs(a.end.getTime()-a.start.getTime());return Math.ceil(s/864e5)}function P(e,t){updateProgressBar(o,e,{useWidth:!0}),updateLabel(o,t)}y.header=getClass(C,"header"),y.labels=getClass(y.header,"labels"),y.body=getClass(C,"body"),C.id="shift_code_".concat(n.id),C.style.animationDelay="".concat(.2*w.added,"s"),e=n.reward,t=getClass(y.labels,"basic"),-1==(getClass(y.header,"reward").innerHTML=e).search("Golden Key")&&(t.childNodes[0].innerHTML="Rare SHiFT Code",updateLabel(t,"Rare SHiFT Code with an uncommon reward")),l=b("exp"),d=m(),c=m(n.rel_date),f=null===(a=n.exp_date)?(addClass(l,"inactive"),"N/A"):m(a),d==c?addClass(C,"new"):y.labels.removeChild(getClass(y.labels,"new")),d==f?addClass(C,"exp"):y.labels.removeChild(getClass(y.labels,"exp")),b("rel").innerHTML=c,l.innerHTML=f,o=getClass(y.header,"progress-bar"),"N/A"!=f?P(c!=f?Math.round(_(d,c)/_(f,c)*100):100,(s=_(d,f),r=1!=s?"s":"","".concat(s," Day").concat(r," Left"))):(P(0,"No Expiration Date"),addClass(o,"inactive")),h=n.source,g=b("src"),u=getClass(g,"link"),p=getClass(g,"no-link"),null!==h?(u.href=h,u.innerHTML+=h,g.removeChild(p)):(addClass(g,"inactive"),g.removeChild(u)),null!==(v=n.notes)?getTag(b("notes"),"ul").innerHTML=function(){if(-1==v.indexOf("-"))return"<li><i>".concat(v,"</i></li>");var e=new RegExp("-.*","g");return v.replace(e,function(e){var t=new RegExp("-\\s{1}","g");return"".concat(e.replace(t,"<li><i>"),"</i></li>")})}():y.body.removeChild(getClass(y.body,"notes")),function(){for(var e=["pc","xbox","ps"],t=0;t<e.length;t++){var a=e[t],s=getClass(y.body,a),r=n["code_".concat(a)];getClass(s,"title").innerHTML=n["platforms_".concat(a)],getClass(s,"display").innerHTML=r,getClass(s,"value").value=r}}(),dropdownPanelSetup(C),function(){var e=getClasses(y.body,"copy");for(i=0;i<e.length;i++)e[i].addEventListener("click",copyToClipboard)}(),w.added++,1==w.added&&(L(),T({overlay:!0,spinner:!0,error:!0})),w.added==w.fetched&&setTimeout(function(){I(!1)},600),x.insertBefore(C,document.getElementById("shift_code_pager"))}I(!0),lpbUpdate(90,!0,{start:20}),newAjaxRequest({file:"/assets/php/scripts/shift/getCodes\n           ?gameID=".concat(shiftProps.gameInfo.id,"\n           &order=").concat(shiftProps.order,"\n           &filter=").concat(shiftProps.filter.join(", "),"\n           &limit=").concat(shiftProps.limit,"\n           &offset=").concat(shiftProps.offset,"\n           &hash=").concat(shiftProps.hash),callback:function(e){var t=tryJSONParse(e);if(t&&0==t.statusCode){var a=t.payload;if(w.fetched=t.payload.length,0<w.fetched)for(var s=0;s<w.fetched;s++)n(a[s]);else L(),T({overlay:!1,spinner:!0,error:!1})}else L(),T({overlay:!1,spinner:!0,error:!1}),function(e){newToast({settings:{template:"exception"},content:{title:"An error has occurred",body:e}})}("We could not retrieve any SHiFT Codes due to an error. Please refresh the page and try again.");lpbUpdate(100)}})}shiftScriptsInit=setInterval(function(){if(globalFunctionsReady){clearInterval(shiftScriptsInit);var d=document.getElementById("shift_header");shiftProps={gameInfo:tryJSONParse(document.body.getAttribute("data-shift")),order:"default",filter:[],limit:10,offset:0,hash:(e=window.location.hash,0==e.search("#shift_code_")&&e.replace("#shift_code_",""))},hashRequests.shift_code_=function(){shiftProps.hash=window.location.hash.replace("#shift_code_",""),getCodes(),hashUpdate(),shiftProps.hash=!1},getCodes(),shiftProps.hash=!1,tryToRun({attempts:!1,delay:500,function:function(){if(shiftStats){var l=shiftProps.gameInfo.id;return function(){new RegExp("\\d{1,2}");for(var e,t,a,s,r,n={total:getClass(d,"badge total"),new:getClass(d,"badge new"),expiring:getClass(d,"badge exp")},i=Object.keys(n),o=0;o<i.length;o++)r=a=e=void 0,t=i[o],a=n[t],s=shiftStats[t][l],e=(e=a.title).replace("No",s),1==s&&(e=e.replace("Codes","Code")),"total"!=t&&(e+=" (Click to Filter)"),r=e,0<s&&(getClass(a,"count").innerHTML=s,updateLabel(a,r),"total"!=t&&a.addEventListener("click",function(e){var t="true"==this.getAttribute("aria-pressed"),a=this.getAttribute("data-value");if(t){var s=shiftProps.filter;updateLabel(this,this.title.replace("clear Filter","Filter")),s.splice(s.indexOf(a),1)}else updateLabel(this,this.title.replace("Filter","clear Filter")),shiftProps.filter.push(a);shiftProps.offset=0,getCodes(),updateShiftPager()}),disenable(a,!1),delClass(a,"inactive"))}(),updateShiftPager(),!0}return!1}}),function(){for(var e=document.getElementById("shift_header_sort_dropdown"),t=getTags(e,"button"),a=0;a<t.length;a++)t[a].addEventListener("click",function(e){var t=this.getAttribute("aria-pressed");t&&"false"!=t||(shiftProps.order=this.getAttribute("data-value"),getCodes())})}()}var e},250);