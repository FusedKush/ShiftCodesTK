var shiftProps={};function updateShiftPager(){for(var l=shiftProps.gameID,e=document.getElementById("shift_code_pager"),d=shiftProps.limit,t=(getClasses(document.getElementById("shift_code_feed"),"shift-code").length,{now:shiftProps.offset/d+1,max:function(){var e=0,t=shiftProps.filter;if(0==t.length)e=shiftStats.total[l];else{var a=!0,r=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;e+=shiftStats[o][l]}}catch(e){r=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(r)throw i}}}return Math.ceil(e/d)}(),offset:d,onclick:"shift_header_sort"}),a=Object.keys(t),r=0;r<a.length;r++){var i=a[r];e.setAttribute("data-".concat(i),t[i])}delClass(e,"configured"),e=configurePager(e);var s=!0,n=!1,o=void 0;try{for(var c,f=getTags(e,"button")[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){c.value.addEventListener("click",function(e){var t=tryParseInt(this.getAttribute("data-value"));t!=shiftProps.offset&&(shiftProps.offset=t,getCodes())})}}catch(e){n=!0,o=e}finally{try{s||null==f.return||f.return()}finally{if(n)throw o}}}function getCodes(){var l={fetched:0,added:0},e=document.getElementById("shift_header"),s={total:getClass(e,"badge total"),new:getClass(e,"badge new"),exp:getClass(e,"badge exp")},d=document.getElementById("shift_code_feed");function c(e){var t={};t.overlay=document.getElementById("shift_overlay"),t.spinner=getClass(t.overlay,"spinner"),t.error=getClass(t.overlay,"error");for(var a=Object.keys(e),r=0;r<a.length;r++){var i=a[r];vishidden(t[i],e[i])}}function f(e){for(var t=[s.new,s.exp,document.getElementById("shift_header_sort")],a=0;a<t.length;a++){var r=t[a];hasClass(r,"inactive")||disenable(r,e)}}function h(){for(var e=getClasses(d,"shift-code"),t=e.length-1;0<=t;t--)d.removeChild(e[t])}function n(u){var e,t,a,r,s,n,o,p=getTemplate("shift_code_template"),v={};function m(e,t){var a=1<arguments.length&&void 0!==t?t:v.body;return getClass(getClass(a,e),"content")}v.header=getClass(p,"header"),v.labels=getClass(v.header,"labels"),v.body=getClass(p,"body"),p.id="shift_code_".concat(u.id),p.style.animationDelay="".concat(.2*l.added,"s"),e=u.reward,t=getClass(v.labels,"basic"),-1==(getClass(v.header,"reward").innerHTML=e).search("Golden Key")&&(t.childNodes[0].innerHTML="Rare SHiFT Code",updateLabel(t,"Rare SHiFT Code with an uncommon reward")),function(){var l="monthN date, year";function i(e){return datetime(l,0<arguments.length&&void 0!==e&&e)}i();var s=["rel","exp"],d={rel:"new",exp:"exp"},c={today:i()};function e(){var e=h[f],r=c[e],i=m(e);function t(e,t){var a=1<arguments.length&&void 0!==t?t:r.str;i.innerHTML+=a,updateLabel(i,e)}if(r.origin&&c.today==r.form?addClass(p,d[e]):v.labels.removeChild(getClass(v.labels,d[e])),r.origin){function a(e){return e.replace(datetime("monthN",r.form),datetime("monthL",r.form))}var s=dateRel(r.origin);if(s){var n=copyElm(i),o="".concat(s,", ").concat(r.str);addClass(n,"day"),n.innerHTML="<span>".concat(r.str.replace(datetime(l,r.origin),s),"</span>"),i.appendChild(n),t(a(o),o)}else t(a(r.str))}else addClass(i,"inactive"),t("No Expiration Date")}!function(){for(var e,t,a=0,r=s;a<r.length;a++)e=void 0,t=r[a],c[t]={},c[t].origin=u["".concat(t,"_date")],c[t].form=i(c[t].origin),c[t].str=(e=c[t].origin)?-1!=e.search("00:00:00")?c[t].form:datetime("".concat(l," @ hour12:minute ampm"),e):"N/A"}();for(var t,a,r,n,o,f=0,h=s;f<h.length;f++)e();function g(e,t){updateProgressBar(n,e,{useWidth:!0}),updateLabel(n,t)}n=getClass(v.header,"progress-bar"),(o=c.exp.origin)?g((a=c.rel.origin,r=c.exp.origin,c.rel.form!=c.exp.form?Math.round(dateDif(a)/dateDif(a,r)*100):100),(t=dateDif(o),"".concat(t," Day").concat(checkPlural(t)," left"))):(g(0,"No Expiration Date"),addClass(n,"inactive"))}(),a=u.source,r=m("src"),s=getClass(r,"link"),n=getClass(r,"no-link"),null!==a?(s.href=a,s.innerHTML+=a,r.removeChild(n)):(addClass(r,"inactive"),r.removeChild(s)),null!==(o=u.notes)?getTag(m("notes"),"ul").innerHTML=function(){if(-1==o.indexOf("-"))return"<li><i>".concat(o,"</i></li>");var e=new RegExp("-.*","g");return o.replace(e,function(e){var t=new RegExp("-\\s{1}","g");return"".concat(e.replace(t,"<li><i>"),"</i></li>")})}():v.body.removeChild(getClass(v.body,"notes")),function(){for(var e=["pc","xbox","ps"],t=0;t<e.length;t++){var a=e[t],r=getClass(v.body,a),i=u["code_".concat(a)];getClass(r,"title").innerHTML=u["platforms_".concat(a)],getClass(r,"display").innerHTML=i,getClass(r,"value").value=i}}(),dropdownPanelSetup(p),function(){var e=getClasses(v.body,"copy");for(i=0;i<e.length;i++)e[i].addEventListener("click",copyToClipboard)}(),l.added++,1==l.added&&(h(),c({overlay:!0,spinner:!0,error:!0})),l.added==l.fetched&&setTimeout(function(){f(!1)},600),d.insertBefore(p,document.getElementById("shift_code_pager"))}f(!0),lpbUpdate(90,!0,{start:20}),newAjaxRequest({file:"/assets/php/scripts/shift/getCodes\n           ?gameID=".concat(shiftProps.gameID,"\n           &order=").concat(shiftProps.order,"\n           &filter=").concat(shiftProps.filter.join(", "),"\n           &limit=").concat(shiftProps.limit,"\n           &offset=").concat(shiftProps.offset,"\n           &hash=").concat(shiftProps.hash),callback:function(e){var t=tryJSONParse(e);if(t&&0==t.statusCode){var a=t.payload;if(l.fetched=t.payload.length,0<l.fetched)for(var r=0;r<l.fetched;r++)n(a[r]);else h(),c({overlay:!1,spinner:!0,error:!1})}else h(),c({overlay:!1,spinner:!0,error:!1}),function(e){newToast({settings:{template:"exception"},content:{title:"An error has occurred",body:e}})}("We could not retrieve any SHiFT Codes due to an error. Please refresh the page and try again.");lpbUpdate(100)}})}shiftScriptsInit=setInterval(function(){if(globalFunctionsReady){clearInterval(shiftScriptsInit);var d=document.getElementById("shift_header");shiftProps={gameID:window.location.pathname.slice(1),order:"default",filter:[],limit:10,offset:0,hash:(e=window.location.hash,0==e.search("#shift_code_")&&e.replace("#shift_code_",""))},hashRequests.shift_code_=function(){shiftProps.hash=window.location.hash.replace("#shift_code_",""),getCodes(),hashUpdate(),shiftProps.hash=!1},getCodes(),shiftProps.hash=!1,tryToRun({attempts:!1,delay:500,function:function(){if(shiftStats){var l=shiftProps.gameID;return function(){new RegExp("\\d{1,2}");for(var e,t,a,r,i,s={total:getClass(d,"badge total"),new:getClass(d,"badge new"),expiring:getClass(d,"badge exp")},n=Object.keys(s),o=0;o<n.length;o++)i=a=e=void 0,t=n[o],a=s[t],r=shiftStats[t][l],e=(e=a.title).replace("No",r),1==r&&(e=e.replace("Codes","Code")),"total"!=t&&(e+=" (Click to Filter)"),i=e,0<r&&(getClass(a,"count").innerHTML=r,updateLabel(a,i),"total"!=t&&a.addEventListener("click",function(e){var t="true"==this.getAttribute("aria-pressed"),a=this.getAttribute("data-value");if(t){var r=shiftProps.filter;updateLabel(this,this.title.replace("clear Filter","Filter")),r.splice(r.indexOf(a),1)}else updateLabel(this,this.title.replace("Filter","clear Filter")),shiftProps.filter.push(a);shiftProps.offset=0,getCodes(),updateShiftPager()}),disenable(a,!1),delClass(a,"inactive"))}(),updateShiftPager(),!0}return!1}}),function(){for(var e=document.getElementById("shift_header_sort_dropdown"),t=getTags(e,"button"),a=0;a<t.length;a++)t[a].addEventListener("click",function(e){var t=this.getAttribute("aria-pressed");t&&"false"!=t||(shiftProps.order=this.getAttribute("data-value"),getCodes())})}()}var e},250);