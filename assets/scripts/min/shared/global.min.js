var globalScrollTimer,hashTargetTimeout,lastFocus,loadEventFired=!1,globalScriptLoaded=!0,globalScrollUpdates=0,defaultDropdownPanelLabels={false:"Expand Panel",true:"Collapse Panel"},focusLock={set:function(e,t){focusLock.active={},focusLock.active.elements=e,focusLock.active.callback=t},clear:function(){focusLock.active=!1},handle:function(e){var t=e.type,a=e.target;if(focusLock.active){var s=focusLock.active.elements,n=function(){var e=[];if(e.push(document.getElementById("alert_popup_feed")),s.constructor===Array){var t=!0,a=!1,n=void 0;try{for(var o,r=s[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value;e.push(i)}}catch(e){a=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}else e.push(s);return e}();if("click"==t){do{var o=!0,r=!1,i=void 0;try{for(var l,d=n[Symbol.iterator]();!(o=(l=d.next()).done);o=!0){if(a==l.value)return}}catch(e){r=!0,i=e}finally{try{o||null==d.return||d.return()}finally{if(r)throw i}}a=a.parentNode}while(a);focusLock.active.callback()}else if("keydown"==t){var c=function(){var e=[];if(s.constructor===Array){var t=!0,a=!1,n=void 0;try{for(var o,r=s[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value;e.push(getElements(i,"focusables"))}}catch(e){a=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}else e.push(s,"focusables");return e}(),u=c[0],p=c[c.length-1];!0===e.shiftKey&&"Tab"==e.key&&a==u||!1===e.shiftKey&&"Tab"==e.key&&a==p?(e.preventDefault(),a==u?p.focus():a==p&&u.focus()):"Escape"==e.key&&(e.preventDefault(),focusLock.active.callback())}}},active:!1},shiftStats=!1,hashRequests={},shiftNames={bl1:"Borderlands: GOTY",bl2:"Borderlands 2",bl3:"Borderlands 3",tps:"Borderlands: The Pre-Sequel"},shiftUpdates={creation_time:"",update_time:"",interval:{id:0,frequency:12e4}};function parseWebpImages(e){var t=document.body.getAttribute("data-webp-support");if(null!==t){var a="true"==t,n=e.getElementsByTagName("*");for(i=0;i<n.length;i++){var o=n[i].getAttribute("data-webp"),r=void 0;null!==o&&((r=JSON.parse(o)).fullPath=r.path,!0==a?r.fullPath+=".webp":!1==a&&(r.fullPath+=r.alt),"bg"==r.type?n[i].style.backgroundImage="url("+r.fullPath+")":"img"==r.type&&(n[i].src=r.fullPath),n[i].removeAttribute("data-webp"))}}else setTimeout(function(){parseWebpImages(e)},250)}function webpSupportUpdate(e){document.body.setAttribute("data-webp-support",e),parseWebpImages(document),document.getElementsByClassName("webp-support")[0].remove()}function addFocusScrollListeners(e){var t=e.getElementsByTagName("*");for(i=0;i<t.length;i++){var a=t[i];"BUTTON"!=a.tagName&&"A"!=a.tagName&&"INPUT"!=a.tagName&&"SELECT"!=a.tagName&&"TEXTAREA"!=a.tagName||!1===a.classList.contains("no-focus-scroll")&&a.addEventListener("focusin",function(e){updateScroll(this)})}}function updateScroll(n){if(!1===hasClass(n,"clipboard-copy")&&!1===hasClass(n,"hidden")){var e=[document.documentElement,document.body],t=null!=(u=n.getAttribute("data-scrollPaddingTop"))?u:0,a=null!=(c=n.getAttribute("data-scrollPaddingBottom"))?c:0,o=64+t,r=e[1].getBoundingClientRect().height-a,i=16,s={};s.base=function(){var e,t=n.tagName.toLowerCase();if("input"!=t&&"select"!=t&&"textarea"!=t)e=n;else for(var a=n;;){if(!0===a.classList.contains("input-container")){e=a;break}a=a.parentNode}return e.getBoundingClientRect()}(),s.top=s.base.top-i,s.bottom=s.base.bottom+i;var l=s.top<o,d=s.bottom>r;if(!0===l)for(x=0;x<e.length;x++)e[x].scrollTop-=o-s.top;else if(!0===d)for(x=0;x<e.length;x++)e[x].scrollTop+=s.bottom-r;!0!==l&&!0!==d||(globalScrollUpdates=0)}var c,u}function toggleBodyScroll(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"toggle",t=document.body,a="scroll-disabled",n="data-last-scroll",o=hasClass(t,a);if(t.scrollHeight>window.innerHeight){if("toggle"==e&&(e=o),e)delClass(t,a),t.style.removeProperty("top"),setTimeout(function(){window.scrollTo(0,tryParseInt(t.getAttribute(n))),t.removeAttribute(n)},50);else{var r=window.pageYOffset;t.setAttribute(n,r),setTimeout(function(){t.style.top="-".concat(r,"px"),addClass(t,a)},50)}return!0}return!1}function hashUpdate(){var t=window.location.hash,e=""!=t;if(function(){var e=document.getElementsByTagName("*");for(i=0;i<e.length;i++)null!==e[i].getAttribute("data-hashtarget-highlighted")&&"#"+e[i].id!=t&&(e[i].removeAttribute("data-hashtarget-highlighted"),e[i].removeEventListener("mouseover",globalListenerHashTargetHover),e[i].removeEventListener("mouseout",globalListenerHashTargetAway)),null!==e[i].getAttribute("data-hashtarget")&&"#"+e[i].id!=t&&(e[i].removeAttribute("data-hashtarget"),e[i].removeEventListener("mouseover",globalListenerHashTargetHover),e[i].removeEventListener("mouseout",globalListenerHashTargetAway))}(),history.replaceState?history.replaceState(null,null,t):window.location.hash=t,!0==e){var a=document.getElementById(t.replace("#",""));!0==(null!==a)&&("true"!=a.getAttribute("data-hashtarget")&&(a.setAttribute("data-hashtarget","visible"),a.addEventListener("mouseover",globalListenerHashTargetHover),a.addEventListener("mouseout",globalListenerHashTargetAway),a.addEventListener("focusin",globalListenerHashTargetHover),a.addEventListener("focusout",globalListenerHashTargetAway)),updateScroll(a))}}function checkHash(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=window.location.hash;function a(e){0==t.search("#".concat(e))&&hashRequests[e](t)}if(e)a(e);else for(var n=Object.keys(hashRequests),o=0;o<n.length;o++)a(n[o])}function addHashListener(e,t){hashRequests[e]=t,checkHash(e)}function updateDropdownPanelAttributes(e,t){var a,n=e.getElementsByClassName("header")[0],o=null===(a=n.getAttribute("data-custom-labels"))?defaultDropdownPanelLabels:JSON.parse(a);e.setAttribute("data-expanded",t),e.setAttribute("aria-expanded",t),n.setAttribute("data-pressed",t),n.setAttribute("aria-pressed",t),n.title=o[t],n.setAttribute("aria-label",o[t])}function addDropdownPanelListener(e){e.getElementsByClassName("header")[0].addEventListener("click",function(e){toggleDropdownPanel(this)})}function dropdownPanelSetup(e){var t=document.createElement("span");if(!0===hasClass(e,"c")){var a=e.parentNode,n={};n.base=getTemplate("dropdown_panel_template"),n.title=getClass(n.base,"title"),n.icon=getClass(n.title,"icon"),n.primary=getClass(n.title,"primary"),n.secondary=getClass(n.title,"secondary"),n.body=getClass(n.base,"body");var o=["icon","primary","secondary","body"];""!=e.id&&(n.base.id=e.id);for(var r=0;r<o.length;r++){var i=o[r],s=getClass(e,i);void 0!==s?n[i].innerHTML=s.innerHTML:n[i].parentNode.removeChild(n[i])}delClass(e,"c"),a.replaceChild(n.base,e),e=n.base}updateDropdownPanelAttributes(e,!1),addDropdownPanelListener(e),t.className="overlay-hashtarget",e.insertBefore(t,e.childNodes[0])}function toggleDropdownPanel(e){var t=e.parentNode,a="true"==t.getAttribute("data-expanded");updateDropdownPanelAttributes(t,!a)}function retrieveDropdownMenuProps(e){var t,a={};return a.id=null===e.id?"dropdown_menu_"+Math.floor(900*Math.random()):e.id,a.target=document.getElementById(e.getAttribute("data-target")),a.toggler=null===(t=e.getAttribute("data-toggler"))?a.target:t,a.pos=e.getAttribute("data-pos"),a.options=getClasses(e,"choice"),a}function updateDropdownMenuPos(e){var t=retrieveDropdownMenuProps(e),a=document.body.getBoundingClientRect(),n=t.target.getBoundingClientRect();e.style.top="calc("+(a.top+"").replace("-","")+"px + "+n.top+"px)",e.style.left=n.left+"px",e.style.bottom="calc("+a.top+"px + "+a.height+"px - "+n.bottom+"px)",e.style.right="calc(100% - "+n.right+"px)"}function toggleDropdownMenu(a){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],t=retrieveDropdownMenuProps(a),n=(document.body.getBoundingClientRect(),t.target.getBoundingClientRect(),"true"==a.getAttribute("data-expanded"));function o(){a.setAttribute("data-expanded",!n),a.setAttribute("aria-expanded",!n),t.toggler.setAttribute("data-pressed",!n),t.toggler.setAttribute("aria-pressed",!n)}!1==n?(updateDropdownMenuPos(a),vishidden(a,!1),setTimeout(function(){o(),window.addEventListener("click",checkDropdownMenuClick),window.addEventListener("keydown",checkDropdownMenuKey),function(){var e=a.getElementsByClassName("choice");for(i=0;i<e.length;i++){var t=e[i];if("true"==t.getAttribute("data-pressed"))return t.focus()}e[0].focus()}()},50)):(o(),window.removeEventListener("click",checkDropdownMenuClick),window.removeEventListener("keydown",checkDropdownMenuKey),setTimeout(function(){vishidden(a,!0),!1===e?t.toggler.focus():document.activeElement.blur()},250))}function setupDropdownMenu(r){var s=retrieveDropdownMenuProps(r);!function(){var e=["target","pos"],t=[];for(i=0;i<e.length;i++){var a=e[i];null===s[a]&&t.push(a)}if(0==t.length){if(function(){var e=document.createElement("div"),t=r.getElementsByClassName("choice");for(addClass(r,"configured"),r.id=s.id,updateDropdownMenuPos(r),r.setAttribute("data-expanded",!1),r.setAttribute("aria-expanded",!1),vishidden(r,!0),e.className="arrow",r.getElementsByClassName("choice-list")[0].setAttribute("role","menu"),i=0;i<t.length;i++){var a=t[i],n=s.id+"_item_"+i+"_label",o=document.createElement("span");o.id=n,o.innerHTML=a.innerHTML,a.setAttribute("role","menuitem"),a.setAttribute("aria-labelledby",n),a.innerHTML="",a.appendChild(o)}r.appendChild(e)}(),s.target.classList.add("dropdown-menu-target"),s.toggler.setAttribute("aria-haspopup","menu"),s.toggler.setAttribute("data-pressed",!1),s.toggler.setAttribute("aria-pressed",!1),s.toggler.setAttribute("autocomplete",!1),s.toggler.addEventListener("click",function(e){toggleDropdownMenu(document.getElementById(s.id))}),function(){function e(e){var a=n[e];hasClass(r,"o-press")&&a.addEventListener("click",function(e){setTimeout(function(){for(var e=0;e<n.length;e++){var t=n[e];"true"==t.getAttribute("aria-pressed")&&t.setAttribute("aria-pressed",!1)}a.setAttribute("aria-pressed",!0)},500)}),hasClass(r,"o-toggle")&&a.addEventListener("click",function(e){toggleDropdownMenu(r)})}for(var n=s.options,t=0;t<n.length;t++)e(t)}(),null===document.getElementById("dropdown_menu_container")){var n=document.createElement("div");n.className="dropdown-menu-container",n.id="dropdown_menu_container",document.body.insertBefore(n,document.body.childNodes[0])}document.getElementById("dropdown_menu_container").appendChild(r)}else console.error('Dropdown Menu "'+s.id+'" is missing the following required properties: "'+t.join('", "')+'". Dropdown Menu Creation Failed.')}()}function copyToClipboard(e){var n=e.currentTarget;(function(){for(var e=parseInt(n.getAttribute("data-copy-target")),t=n,a=0;a<e;a++)t=t.parentNode;return getClass(t,"clipboard-copy")})().select(),document.execCommand("copy"),n.classList.remove("animated"),setTimeout(function(){n.classList.add("animated"),newToast({settings:{duration:"short",id:"clipboard-copy"},content:{icon:"fas fa-clipboard",title:"Copied to Clipboard",body:"This may not work in all browsers"},close:{use:!1}})},25)}function fixClickableContent(e){for(var t=e.childNodes,a=0;a<t.length;a++){var n=t[a];if("#text"==n.nodeName){var o=document.createElement("span");o.innerHTML=n.textContent,e.replaceChild(o,n)}}}function btnPressToggle(e){e.addEventListener("click",function(e){var t,a=e.currentTarget,n=!!(t=a.getAttribute("aria-pressed"))&&"true"==t;setTimeout(function(){a.setAttribute("aria-pressed",!n)},500)})}function checkShiftUpdate(){var p=0<arguments.length&&void 0!==arguments[0]&&arguments[0];newAjaxRequest({file:"/assets/php/scripts/shift/checkForUpdates",callback:function(e){var t,a,n,o,r,i,s,l,d=tryJSONParse(e);if(d){d=d.payload;for(var c=0,u=["creation","update"];c<u.length;c++)t=void 0,a=u[c],n="".concat(a,"_time"),o=d[n].timestamp,r=shiftUpdates[n],i=d[n].game_id,s=shiftNames[i],l="/".concat(i)==window.location.pathname,r<o&&!p&&("creation"!=a&&!l||(shiftUpdates.interval.clear(),newToast({settings:{id:"shift_update_notice",duration:"infinite"},content:{icon:"fas fa-key",title:"creation"==a?"New SHiFT Code for ".concat(s,"!"):"SHiFT Code update for ".concat(s,"!"),body:(t="","creation"==a?(t+="A new SHiFT Code has just been added to ShiftCodesTK! ",t+=l?"Reload the page to access the new code.":"Do you want to go there now?"):t+="A SHiFT Code has just been updated. Reload the page for changes to take effect.",t)},action:{use:!0,type:"link",link:l?" ":"/".concat(i),name:l?"Reload":"View code",label:l?"Reload the current page.":"Visit the ".concat(s," SHiFT Code page")}}))),shiftUpdates[n]=o}else shiftUpdates.interval.clear()}})}function globalListenerLoadClearScroll(){globalScrollUpdates=0,window.removeEventListener("load",globalListenerLoadClearScroll)}function globalListenerHashTargetHover(e){var t=this;hashTargetTimeout=setTimeout(function(){t.setAttribute("data-hashtarget","seen"),t.removeEventListener("mouseover",globalListenerHashTargetHover),t.removeEventListener("mouseout",globalListenerHashTargetAway),t.removeEventListener("focusin",globalListenerHashTargetHover),t.removeEventListener("focusout",globalListenerHashTargetAway)},750)}function globalListenerHashTargetAway(){clearTimeout(hashTargetTimeout)}function checkDropdownMenuClick(e){var t=e.target,a=function(){var e=document.getElementsByClassName("dropdown-menu");for(i=0;i<e.length;i++)if("true"==e[i].getAttribute("data-expanded"))return e[i]}();do{if(t==a)return;t=t.parentNode}while(t);toggleDropdownMenu(a,!0)}function checkDropdownMenuKey(e){var t=e.target,a=function(){var e=document.getElementsByClassName("dropdown-menu");for(i=0;i<e.length;i++)if("true"==e[i].getAttribute("data-expanded"))return e[i]}(),n=a.getElementsByClassName("choice"),o=n[0],r=n[n.length-1];!0===e.shiftKey&&"Tab"==e.key&&t==o||!1===e.shiftKey&&"Tab"==e.key&&t==r?(e.preventDefault(),t==o?r.focus():t==r&&o.focus()):"Escape"==e.key&&(e.preventDefault(),toggleDropdownMenu(a))}function execGlobalScripts(){var e;"boolean"==typeof globalFunctionsReady?((e=document.createElement("img")).classList.add("webp-support"),e.onload=function(){webpSupportUpdate(!0)},e.onerror=function(){webpSupportUpdate(!1)},e.src="/assets/img/webp_support.webp",document.body.appendChild(e),hashUpdate(),function(){for(var e=document.getElementsByClassName("dropdown-panel"),t=0;t<e.length;t++)dropdownPanelSetup(e[t])}(),function(){var e=document.getElementsByClassName("dropdown-menu");for(i=0;i<e.length;i++)setupDropdownMenu(e[i])}(),function(){var e;if(document.getElementById("primary_header")){function u(e){var t=getTemplate(n[e.type]);"separator"!=e.type&&("crumb"==e.type&&(t.href=e.link,updateLabel(t,e.title)),e.icon?addClass(t,e.icon):t.innerHTML=e.title),a.appendChild(t)}var p={bl1:"Borderlands: GOTY",bl2:"Borderlands 2",tps:"Borderlands: The Pre-Sequel",bl3:"Borderlands 3","about-us":"About us",credits:"Credits",updates:"Updates",help:"Help Center","clearing-your-system-cache":"Clearing your System Cache",faq:"FAQ","how-to-redeem":"How to Redeem","borderlands-website":"Borderlands Website","shift-website":"SHiFT Website"},g=("/"==(e=window.location.pathname)[e.length-1]&&(e=e.slice(0,-1)),e),h=g.slice(1),a=document.getElementById("breadcrumb_container"),n={separator:"breadcrumb_separator_template",crumb:"breadcrumb_crumb_template",here:"breadcrumb_crumb_here_template"},t=Object.keys(n);u({type:"crumb",title:"Home",icon:"fas fa-home",link:"/"}),u({type:"separator"}),function(){var e=new RegExp("(\\/)|([\\w-]+)","g"),t=!0,a=!1,n=void 0;try{for(var o,r=regexMatchAll(e,h)[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value[0];if("/"==i)u({type:"separator"});else{var s="/".concat(i),l=new RegExp("\\/","g"),d=new RegExp("".concat(s,"(.*)")),c={title:p[i.replace(l,"")],link:g.replace(d,s)};c.link!=g?c.type="crumb":c.type="here",u(c)}}}catch(e){a=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}(),addClass(a.parentNode,"ready");for(var o=0,r=t;o<r.length;o++){var i=r[o];document.getElementById(n[i]).remove()}}}(),newAjaxRequest({file:"/assets/php/scripts/shift/getStats.php",callback:function(e){var t=tryJSONParse(e);t?shiftStats=t.payload:newToast({settings:{template:"exception"},content:{body:"We could not retrieve SHiFT Code statistics due to an error. This may affect the site until refreshed."}})}}),function(){for(var e=getElements(document,"clickables"),t=0;t<e.length;t++)fixClickableContent(e[t])}(),function(){for(var e=getTags(document,"button"),t=0;t<e.length;t++){var a=e[t];hasClass(a,"o-pressed")&&btnPressToggle(a)}}(),window.addEventListener("hashchange",function(e){event.preventDefault(),checkHash(),hashUpdate()}),window.addEventListener("scroll",function(){null!==globalScrollTimer&&clearTimeout(globalScrollTimer),globalScrollUpdates++,globalScrollTimer=setTimeout(function(){if(1==globalScrollUpdates){var e=document.getElementsByTagName("*");for(i=0;i<e.length;i++){var t=e[i].getBoundingClientRect().top;0<=t&&t<=1&&hashUpdate()}}globalScrollUpdates=0},150)}),window.addEventListener("load",globalListenerLoadClearScroll),addFocusScrollListeners(document),function(){var e=document.getElementsByTagName("a");for(i=0;i<e.length;i++)""!=e[i].hash&&e[i].addEventListener("click",hashUpdate)}(),window.addEventListener("click",focusLock.handle),window.addEventListener("keydown",focusLock.handle),function(){var e=document.getElementById("dropdown_menu_container");if(null!==e){var n=getClasses(e,"dropdown-menu");window.addEventListener("resize",function(e){for(var t=0;t<n.length;t++){var a=n[t];a.getAttribute("data-expanded")&&updateDropdownMenuPos(a)}})}}()):setTimeout(execGlobalScripts,250)}shiftUpdates.interval.set=function(){shiftUpdates.interval.id=setInterval(checkShiftUpdate,shiftUpdates.interval.frequency)},shiftUpdates.interval.clear=function(){clearInterval(shiftUpdates.interval.id)},execGlobalScripts(),window.addEventListener("load",function(){loadEventFired=!0,setTimeout(function(){var e;(e=document.getElementById("startup")).parentNode.removeChild(e),checkShiftUpdate(!0),shiftUpdates.interval.set()},2500)});