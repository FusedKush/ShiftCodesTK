var globalScrollTimer,hashTargetTimeout,lastFocus,ShiftCodesTK={},loadEventFired=!1,globalScriptLoaded=!0,globalScrollUpdates=0,focusLock={set:function(e,t){focusLock.active={},focusLock.active.elements=e,focusLock.active.callback=t},clear:function(){focusLock.active=!1},handle:function(e){var t=e.type,a=e.target;if(focusLock.active){var o,r,n,l=focusLock.active.elements,i=function(){var e=[];if(e.push(ShiftCodesTK.toasts.containers.activeToasts),"Array"==l.constructor.name){var t=!0,a=!1,o=void 0;try{for(var r,n=l[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var i=r.value;e.push(i)}}catch(e){a=!0,o=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw o}}}else e.push(l);return e}();if("click"==t){do{var s=!0,c=!1,d=void 0;try{for(var u,h=i[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){if(a==u.value)return!0}}catch(e){c=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw d}}a=a.parentNode}while(a);focusLock.active.callback()}else{"keydown"==t&&(r=(o=function(){var e=[];if(l.constructor===Array){var t=!0,a=!1,o=void 0;try{for(var r,n=l[Symbol.iterator]();!(t=(r=n.next()).done);t=!0)var i=r.value,e=e.concat(dom.find.children(i,"group","focusables"))}catch(e){a=!0,o=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw o}}}else e=e.concat(dom.find.children(l,"group","focusables"));return e}())[0],n=o[o.length-1],!0===e.shiftKey&&"Tab"==e.key&&a==r||!1===e.shiftKey&&"Tab"==e.key&&a==n?(e.preventDefault(),a==r?n.focus():a==n&&r.focus()):"Escape"==e.key&&(e.preventDefault(),focusLock.active.callback()))}}},active:!1},shiftStats=!1,hashListeners={},requestToken={tagName:"tk-request-token",check:function(u){newAjaxRequest({file:"/assets/requests/get/token",callback:function(e){var t=requestToken.get(),a=tryJSONParse(e);if(a&&200==a.statusCode){var o=a.payload.token;if("unchanged"!=o){var r=dom.find.children(document.body,"attr","name","auth_token"),t=o;edit.attr(getMetaTag(requestToken.tagName),"add","content",t);var n=!0,i=!1,l=void 0;try{for(var s,c=r[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var d=s.value;edit.attr(d,"add","value",t)}}catch(e){i=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw l}}"function"==typeof u&&u(t)}}else newToast({settings:{template:"exception"},content:{body:"Your request token could not be updated due to an error. This may affect the site until refreshed."}})}})},get:function(){return getMetaTag(requestToken.tagName).content}},shiftNames={bl1:"Borderlands: GOTY",bl2:"Borderlands 2",bl3:"Borderlands 3",tps:"Borderlands: The Pre-Sequel"};function parseWebpImages(e){var t=document.body.getAttribute("data-webp-support");if(null!==t){var a="true"==t,o=e.getElementsByTagName("*");for(i=0;i<o.length;i++){var r=o[i].getAttribute("data-webp"),n=void 0;null!==r&&((n=JSON.parse(r)).fullPath=n.path,!0==a?n.fullPath+=".webp":!1==a&&(n.fullPath+=n.alt),"bg"==n.type?o[i].style.backgroundImage="url("+n.fullPath+")":"img"==n.type&&(o[i].src=n.fullPath),o[i].removeAttribute("data-webp"))}}else setTimeout(function(){parseWebpImages(e)},250)}function webpSupportUpdate(e){document.body.setAttribute("data-webp-support",e),parseWebpImages(document),document.getElementsByClassName("webp-support")[0].remove()}function addFocusScrollListeners(e){var t=e.getElementsByTagName("*");for(i=0;i<t.length;i++){var a=t[i];"BUTTON"!=a.tagName&&"A"!=a.tagName&&"INPUT"!=a.tagName&&"SELECT"!=a.tagName&&"TEXTAREA"!=a.tagName||!1===a.classList.contains("no-focus-scroll")&&a.addEventListener("focusin",function(e){updateScroll(this)})}}function updateScroll(o){if(!dom.has(o,"class","clipboard-copy")&&!dom.has(o,"class","hidden")){var e=[document.documentElement,document.body],t=null!=(u=o.getAttribute("data-scrollPaddingTop"))?u:0,a=null!=(d=o.getAttribute("data-scrollPaddingBottom"))?d:0,r=64+t,n=e[1].getBoundingClientRect().height-a,i=16,l={};l.base=function(){var e,t=o.tagName.toLowerCase();if("input"!=t&&"select"!=t&&"textarea"!=t)e=o;else for(var a=o;;){if(!0===a.classList.contains("input-container")){e=a;break}a=a.parentNode}return e.getBoundingClientRect()}(),l.top=l.base.top-i,l.bottom=l.base.bottom+i;var s=l.top<r,c=l.bottom>n;if(!0===s)for(x=0;x<e.length;x++)e[x].scrollTop-=r-l.top;else if(!0===c)for(x=0;x<e.length;x++)e[x].scrollTop+=l.bottom-n;!0!==s&&!0!==c||(globalScrollUpdates=0)}var d,u}function toggleBodyScroll(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"toggle",a=document.body,o="scroll-disabled",r="data-last-scroll",n=dom.has(a,"class",o);return a.scrollHeight>window.innerHeight&&(t!=!n&&("toggle"==t&&(t=n),t?(edit.class(a,"remove",o),a.style.removeProperty("top"),setTimeout(function(){window.scrollTo(0,tryParseInt(a.getAttribute(r))),a.removeAttribute(r)},50)):(e=window.pageYOffset,a.setAttribute(r,e),setTimeout(function(){a.style.top="-".concat(e,"px"),edit.class(a,"add",o)},50)),!0))}function hashUpdate(){var e,t=window.location.hash,a=""!=t;!function(){var e=document.getElementsByTagName("*");for(i=0;i<e.length;i++)null!==e[i].getAttribute("data-hashtarget-highlighted")&&"#"+e[i].id!=t&&(e[i].removeAttribute("data-hashtarget-highlighted"),e[i].removeEventListener("mouseover",globalListenerHashTargetHover),e[i].removeEventListener("mouseout",globalListenerHashTargetAway)),null!==e[i].getAttribute("data-hashtarget")&&"#"+e[i].id!=t&&(e[i].removeAttribute("data-hashtarget"),e[i].removeEventListener("mouseover",globalListenerHashTargetHover),e[i].removeEventListener("mouseout",globalListenerHashTargetAway))}(),history.replaceState?history.replaceState(null,null,t):window.location.hash=t,!0!=a||!0==(null!==(e=document.getElementById(t.replace("#",""))))&&("true"!=e.getAttribute("data-hashtarget")&&(e.setAttribute("data-hashtarget","visible"),e.addEventListener("mouseover",globalListenerHashTargetHover),e.addEventListener("mouseout",globalListenerHashTargetAway),e.addEventListener("focusin",globalListenerHashTargetHover),e.addEventListener("focusout",globalListenerHashTargetAway)),updateScroll(e))}function checkHash(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=window.location.hash;function a(e){return 0==t.search("#".concat(e))&&(hashListeners[e](t),1)}if(e){if(a(e))return!0}else for(var o=Object.keys(hashListeners),r=0;r<o.length;r++)if(a(o[r]))return!0;return!1}function addHashListener(e,t){return hashListeners[e]=t,checkHash(e)}function copyToClipboard(e){var o=e.currentTarget;(function(){for(var e=parseInt(o.getAttribute("data-copy-target")),t=o,a=0;a<e;a++)t=t.parentNode;return dom.find.child(t,"class","clipboard-copy")})().select(),document.execCommand("copy"),o.classList.remove("animated"),setTimeout(function(){o.classList.add("animated"),newToast({settings:{duration:"short",id:"clipboard-copy"},content:{icon:"fas fa-clipboard",title:"Copied to Clipboard",body:"This may not work in all browsers"},close:{use:!1}})},25)}function fixClickableContent(e){for(var t=e.childNodes,a=0;a<t.length;a++){var o,r=t[a];"#text"==r.nodeName&&((o=document.createElement("span")).innerHTML=r.textContent,e.replaceChild(o,r))}}function btnPressToggle(e){e.addEventListener("click",function(e){var t=e.currentTarget,a=dom.has(t,"attr","aria-pressed","true");setTimeout(function(){t.setAttribute("aria-pressed",!a)},500)})}function globalListenerLoadClearScroll(){globalScrollUpdates=0,window.removeEventListener("load",globalListenerLoadClearScroll)}function globalListenerHashTargetHover(e){var t=this;hashTargetTimeout=setTimeout(function(){t.setAttribute("data-hashtarget","seen"),t.removeEventListener("mouseover",globalListenerHashTargetHover),t.removeEventListener("mouseout",globalListenerHashTargetAway),t.removeEventListener("focusin",globalListenerHashTargetHover),t.removeEventListener("focusout",globalListenerHashTargetAway),history.pushState?history.pushState(null,null,window.location.href.split("#")[0]):window.location.hash="##"},750)}function globalListenerHashTargetAway(){clearTimeout(hashTargetTimeout)}function execGlobalScripts(){var e;"boolean"==typeof globalFunctionsReady?((e=document.createElement("img")).classList.add("webp-support"),e.onload=function(){webpSupportUpdate(!0)},e.onerror=function(){webpSupportUpdate(!1)},e.src="/assets/img/webp_support.webp",document.body.appendChild(e),hashUpdate(),newAjaxRequest({file:"/assets/requests/get/shift/stats",callback:function(e){var t=tryJSONParse(e);t?shiftStats=t.payload:newToast({settings:{template:"exception"},content:{body:"We could not retrieve SHiFT Code statistics due to an error. This may affect the site until refreshed."}})}}),function(){for(var e=dom.find.children(document,"group","clickables"),t=0;t<e.length;t++)fixClickableContent(e[t])}(),function(){for(var e=dom.find.children(document,"tag","button"),t=0;t<e.length;t++){var a=e[t];dom.has(a,"class","o-pressed")&&btnPressToggle(a)}}(),function(){var e={};e.main=dom.find.id("containers"),e.modals=dom.find.id("modals"),e.templates=dom.find.id("templates");var t={modals:dom.find.children(document.body,"class","modal"),templates:dom.find.children(document.body,"tag","template")};for(var a in t){var o=e[a],r=t[a],n=!0,i=!1,l=void 0;try{for(var s,c=r[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var d=s.value;d.parentNode!=o&&o.appendChild(d)}}catch(e){i=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw l}}}}(),window.addEventListener("hashchange",function(e){event.preventDefault(),checkHash(),hashUpdate()}),window.addEventListener("scroll",function(){null!==globalScrollTimer&&clearTimeout(globalScrollTimer),globalScrollUpdates++,globalScrollTimer=setTimeout(function(){if(1==globalScrollUpdates){var e=document.getElementsByTagName("*");for(i=0;i<e.length;i++){var t=e[i].getBoundingClientRect().top;0<=t&&t<=1&&hashUpdate()}}globalScrollUpdates=0},150)}),window.addEventListener("load",globalListenerLoadClearScroll),addFocusScrollListeners(document),function(){var e=document.getElementsByTagName("a");for(i=0;i<e.length;i++)""!=e[i].hash&&e[i].addEventListener("click",hashUpdate)}(),window.addEventListener("click",focusLock.handle),window.addEventListener("keydown",focusLock.handle),ShiftCodesTK.cursor={},window.addEventListener("mousemove",function(e){ShiftCodesTK.cursor={x:e.clientX,y:e.clientY,target:e.target}})):setTimeout(execGlobalScripts,250)}execGlobalScripts(),window.addEventListener("load",function(){loadEventFired=!0});